import{f as k,a as u,c as ga}from"../chunks/DcfGaW49.js";import{i as ma}from"../chunks/CZvVAo7f.js";import{p as ya,o as xa,R as Q,T as ha,H as t,I as V,a as Wa,c as a,v as B,s as w,u as v,K as s,O as e,J as X,U as j}from"../chunks/QHsq6-My.js";import{s as o}from"../chunks/Bu0Oie1f.js";import{i as F}from"../chunks/DDK3JoqH.js";import{l as Sa,s as wa,g as Da,f as G,W as H,e as ba}from"../chunks/BFnZqG6b.js";import{a as Ra,b as La,c as Ma}from"../chunks/BdKrEQe7.js";var Ta=k("<p>Loadingâ€¦</p>"),Ia=k('<div class="kv svelte-1rn3i1x"><span>Deload reasons</span><span> </span></div>'),Aa=k('<section class="card highlight svelte-1rn3i1x"><h2 class="svelte-1rn3i1x"> </h2> <div class="kv svelte-1rn3i1x"><span>Training points</span><span> </span></div> <div class="kv svelte-1rn3i1x"><span>Wins</span><span> </span></div> <div class="kv svelte-1rn3i1x"><span>Missed days</span><span> </span></div> <div class="kv svelte-1rn3i1x"><span>Weekly rating</span> <span> </span></div> <div class="kv svelte-1rn3i1x"><span>Deload</span><span> </span></div> <!> <div class="kv svelte-1rn3i1x"><span>Win streak</span><span> </span></div> <div class="kv svelte-1rn3i1x"><span>Consistency streak</span><span> </span></div></section>'),Ba=k("<p>No entries yet.</p>"),Ea=k('<section class="card svelte-1rn3i1x"><h2 class="svelte-1rn3i1x"> </h2> <div class="kv svelte-1rn3i1x"><span>Training points</span><span> </span></div> <div class="kv svelte-1rn3i1x"><span>Wins</span><span> </span></div> <div class="kv svelte-1rn3i1x"><span>Missed days</span><span> </span></div> <div class="kv svelte-1rn3i1x"><span>Weekly rating</span> <span> </span></div> <div class="kv svelte-1rn3i1x"><span>Deload</span><span> </span></div></section>'),$a=k("<!> <!>",1),Ca=k("<h1>Weekly Dashboard</h1> <!>",1);function Ga(ra,ia){ya(ia,!1);const r=B(),Z=B(),aa=B();let J=B(!0),c=B([]);function va(n){const p=n.slice().sort((l,g)=>l.date>g.date?-1:1),d=[];for(const l of p){const g=Da(l.date),E=d.find(([O])=>O===g);E?E[1].push(l):d.push([g,[l]])}return d}function oa(){const n=wa(new Date),p=n.getFullYear(),d=String(n.getMonth()+1).padStart(2,"0"),l=String(n.getDate()).padStart(2,"0");return`${p}-${d}-${l}`}async function pa(){w(J,!0);try{const n=await Sa(500),p=va(n);w(c,Ma(p.map(([d,l])=>({weekStart:d,days:l}))))}finally{w(J,!1)}}xa(pa);function da(n){const p={scheduled:"scheduled",fatigued_days:"4+ fatigued days",high_average:"high 3-week average"};return n.map(d=>p[d]).join(", ")}Q(()=>a(c),()=>{w(r,a(c).find(n=>n.weekStart===oa())??null)}),Q(()=>a(c),()=>{w(Z,Ra(a(c).flatMap(n=>n.days.map(p=>p.day))))}),Q(()=>a(c),()=>{w(aa,La(a(c)))}),ha(),ma();var sa=Ca(),la=t(V(sa),2);{var ca=n=>{var p=Ta();u(n,p)},_a=n=>{var p=$a(),d=V(p);{var l=_=>{var f=Aa(),D=s(f),b=s(D);e(D);var i=t(D,2),m=t(s(i)),R=s(m,!0);e(m),e(i);var L=t(i,2),y=t(s(L)),$=s(y,!0);e(y),e(L);var M=t(L,2),x=t(s(M)),C=s(x,!0);e(x),e(M);var T=t(M,2),h=t(s(T),2),K=s(h,!0);e(h),e(T);var I=t(T,2),W=t(s(I)),N=s(W,!0);e(W),e(I);var P=t(I,2);{var U=A=>{var z=Ia(),na=t(s(z)),ua=s(na,!0);e(na),e(z),X(ka=>o(ua,ka),[()=>(a(r),v(()=>da(a(r).deloadReasons)))]),u(A,z)};F(P,A=>{a(r),v(()=>a(r).deload&&a(r).deloadReasons.length>0)&&A(U)})}var S=t(P,2),Y=t(s(S)),q=s(Y);e(Y),e(S);var ea=t(S,2),ta=t(s(ea)),fa=s(ta);e(ta),e(ea),e(f),X(A=>{o(b,`This week (${a(r),v(()=>a(r).weekStart)??""})`),o(R,(a(r),v(()=>a(r).trainingPoints))),o($,(a(r),v(()=>a(r).wins))),o(C,(a(r),v(()=>a(r).missedDays))),o(K,A),o(N,(a(r),v(()=>a(r).deload?"yes":"no"))),o(q,`${a(Z)??""} days`),o(fa,`${a(aa)??""} weeks`)},[()=>(j(G),j(H),a(r),v(()=>G(H[a(r).weeklyRating])))]),u(_,f)};F(d,_=>{a(r)&&_(l)})}var g=t(d,2);{var E=_=>{var f=Ba();u(_,f)},O=_=>{var f=ga(),D=V(f);ba(D,1,()=>a(c),b=>b.weekStart,(b,i)=>{var m=Ea(),R=s(m),L=s(R);e(R);var y=t(R,2),$=t(s(y)),M=s($,!0);e($),e(y);var x=t(y,2),C=t(s(x)),T=s(C,!0);e(C),e(x);var h=t(x,2),K=t(s(h)),I=s(K,!0);e(K),e(h);var W=t(h,2),N=t(s(W),2),P=s(N,!0);e(N),e(W);var U=t(W,2),S=t(s(U)),Y=s(S,!0);e(S),e(U),e(m),X(q=>{o(L,`Week of ${a(i),v(()=>a(i).weekStart)??""}`),o(M,(a(i),v(()=>a(i).trainingPoints))),o(T,(a(i),v(()=>a(i).wins))),o(I,(a(i),v(()=>a(i).missedDays))),o(P,q),o(Y,(a(i),v(()=>a(i).deload?"yes":"no")))},[()=>(j(G),j(H),a(i),v(()=>G(H[a(i).weeklyRating])))]),u(b,m)}),u(_,f)};F(g,_=>{a(c),v(()=>a(c).length===0)?_(E):_(O,!1)})}u(n,p)};F(la,n=>{a(J)?n(ca):n(_a,!1)})}u(ra,sa),Wa()}export{Ga as component};
