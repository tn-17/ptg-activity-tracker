import{f,a as n,c as P,t as $}from"../chunks/CtCoybIn.js";import{i as aa}from"../chunks/BKqJgErF.js";import{p as ea,o as ta,G as p,H as L,a as sa,d as e,y as T,s as A,c as v,r as d,t as B}from"../chunks/DTfDAl4_.js";import{s as _}from"../chunks/zLC_yYsZ.js";import{i as k}from"../chunks/7tgxHHI9.js";import{l as ra,g as oa,e as U}from"../chunks/BDHSxgV7.js";import{s as la}from"../chunks/CvDsuMjO.js";import{c as na}from"../chunks/D-yFYO2n.js";var ia=f("<p>Loadingâ€¦</p>"),da=f('<p>No entries yet. Go to <a href="/log">Log</a> to create one.</p>'),va=f('<p class="deload">Deload: yes<!></p>'),pa=f('<p class="deload">Deload: no</p>'),fa=f('<a class="row svelte-1xl2tfr"><span class="date"> </span> <span class="meta svelte-1xl2tfr"> </span> <span class="tier svelte-1xl2tfr"> </span> <span class="total svelte-1xl2tfr"> </span></a>'),ca=f('<section class="week svelte-1xl2tfr"><h2> </h2> <!> <div class="list svelte-1xl2tfr"></div></section>'),ma=f('<h1>History</h1> <a class="new svelte-1xl2tfr" href="/log">New / Today</a> <!>',1);function ba(q,z){ea(z,!1);function C(t){const o={scheduled:"scheduled",fatigued_days:"4+ fatigued days",high_average:"high 3-week average"};return t.map(u=>o[u]).join(", ")}let w=T(!0),x=T([]);function E(t){const o=new Map;for(const s of t){const a=oa(s.date),i=o.get(a);i?i.push(s):o.set(a,[s])}const u=Array.from(o.entries()).map(([s,a])=>({weekStart:s,days:a.slice().sort((i,b)=>i.date>b.date?-1:1)})).sort((s,a)=>s.weekStart>a.weekStart?1:-1);return na(u).map(s=>({week:s}))}async function F(){A(w,!0);try{const t=await ra(400);A(x,E(t))}finally{A(w,!1)}}ta(F),aa();var H=ma(),J=p(L(H),4);{var K=t=>{var o=ia();n(t,o)},O=t=>{var o=P(),u=L(o);{var I=a=>{var i=da();n(a,i)},s=a=>{var i=P(),b=L(i);U(b,1,()=>e(x),S=>S.week.weekStart,(S,y)=>{var D=ca(),R=v(D),Q=v(R);d(R);var M=p(R,2);{var V=l=>{var r=va(),c=p(v(r));{var g=h=>{var m=$();B(W=>_(m,`\0 Reasons: ${W??""}`),[()=>C(e(y).week.deloadReasons)]),n(h,m)};k(c,h=>{e(y).week.deloadReasons.length>0&&h(g)})}d(r),n(l,r)},X=l=>{var r=pa();n(l,r)};k(M,l=>{e(y).week.deload?l(V):l(X,!1)})}var N=p(M,2);U(N,5,()=>e(y).week.days,l=>l.day.date,(l,r)=>{var c=fa(),g=v(c),h=v(g,!0);d(g);var m=p(g,2),W=v(m,!0);d(m);var G=p(m,2),Y=v(G,!0);d(G);var j=p(G,2),Z=v(j,!0);d(j),d(c),B(()=>{la(c,"href",`/log?date=${e(r).day.date}`),_(h,e(r).day.date),_(W,e(r).day.readiness),_(Y,e(r).scores.trainingRating),_(Z,e(r).scores.totalPoints)}),n(l,c)}),d(N),d(D),B(()=>_(Q,`Week of ${e(y).week.weekStart??""}`)),n(S,D)}),n(a,i)};k(u,a=>{e(x).length===0?a(I):a(s,!1)},!0)}n(t,o)};k(J,t=>{e(w)?t(K):t(O,!1)})}n(q,H),sa()}export{ba as component};
