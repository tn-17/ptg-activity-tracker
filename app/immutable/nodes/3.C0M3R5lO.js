import{f,a as i,c as P,t as sa}from"../chunks/CT3D-Iho.js";import{i as ra}from"../chunks/BXyBdR38.js";import{p as oa,o as la,H as p,I as M,J as x,a as na,c as t,v as T,s as A,K as d,M as ia,O as v}from"../chunks/Bbatwou0.js";import{s as _}from"../chunks/DIgocRep.js";import{i as b}from"../chunks/CtOTHBIA.js";import{l as va,g as pa,e as U}from"../chunks/Dr3jCEEA.js";import{s as B}from"../chunks/DLCH2CcZ.js";import{r as G}from"../chunks/CML63xel.js";import{c as da}from"../chunks/CVUIyC4T.js";var fa=f("<p>Loadingâ€¦</p>"),ca=f("<p>No entries yet. Go to <a>Log</a> to create one.</p>"),ma=f('<p class="deload">Deload: yes<!></p>'),_a=f('<p class="deload">Deload: no</p>'),ua=f('<a class="row svelte-1xl2tfr"><span class="date"> </span> <span class="meta svelte-1xl2tfr"> </span> <span class="tier svelte-1xl2tfr"> </span> <span class="total svelte-1xl2tfr"> </span></a>'),ga=f('<section class="week svelte-1xl2tfr"><h2> </h2> <!> <div class="list svelte-1xl2tfr"></div></section>'),ha=f('<h1>History</h1> <a class="new svelte-1xl2tfr">New / Today</a> <!>',1);function Ia(q,z){oa(z,!1);function C(a){const l={scheduled:"scheduled",fatigued_days:"4+ fatigued days",high_average:"high 3-week average"};return a.map(u=>l[u]).join(", ")}let S=T(!0),D=T([]);function E(a){const l=new Map;for(const s of a){const e=pa(s.date),r=l.get(e);r?r.push(s):l.set(e,[s])}const u=Array.from(l.entries()).map(([s,e])=>({weekStart:s,days:e.slice().sort((r,g)=>r.date>g.date?-1:1)})).sort((s,e)=>s.weekStart>e.weekStart?1:-1);return da(u).map(s=>({week:s}))}async function F(){A(S,!0);try{const a=await va(400);A(D,E(a))}finally{A(S,!1)}}la(F),ra();var H=ha(),N=p(M(H),2),Q=p(N,2);{var V=a=>{var l=fa();i(a,l)},X=a=>{var l=P(),u=M(l);{var j=e=>{var r=ca(),g=p(d(r));ia(),v(r),x(h=>B(g,"href",h),[()=>G("/log")]),i(e,r)},s=e=>{var r=P(),g=M(r);U(g,1,()=>t(D),h=>h.week.weekStart,(h,y)=>{var R=ga(),W=d(R),Y=d(W);v(W);var J=p(W,2);{var Z=n=>{var o=ma(),c=p(d(o));{var k=w=>{var m=sa();x(I=>_(m,`Reasons: ${I??""}`),[()=>C(t(y).week.deloadReasons)]),i(w,m)};b(c,w=>{t(y).week.deloadReasons.length>0&&w(k)})}v(o),i(n,o)},$=n=>{var o=_a();i(n,o)};b(J,n=>{t(y).week.deload?n(Z):n($,!1)})}var K=p(J,2);U(K,5,()=>t(y).week.days,n=>n.day.date,(n,o)=>{var c=ua(),k=d(c),w=d(k,!0);v(k);var m=p(k,2),I=d(m,!0);v(m);var L=p(m,2),aa=d(L,!0);v(L);var O=p(L,2),ea=d(O,!0);v(O),v(c),x(ta=>{B(c,"href",ta),_(w,t(o).day.date),_(I,t(o).day.readiness),_(aa,t(o).scores.trainingRating),_(ea,t(o).scores.totalPoints)},[()=>G("/log")+`?date=${t(o).day.date}`]),i(n,c)}),v(K),v(R),x(()=>_(Y,`Week of ${t(y).week.weekStart??""}`)),i(h,R)}),i(e,r)};b(u,e=>{t(D).length===0?e(j):e(s,!1)},!0)}i(a,l)};b(Q,a=>{t(S)?a(V):a(X,!1)})}x(a=>B(N,"href",a),[()=>G("/log")]),i(q,H),na()}export{Ia as component};
