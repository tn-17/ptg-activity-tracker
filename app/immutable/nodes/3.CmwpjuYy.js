import{f,a as n,c as J,t as $}from"../chunks/1VXHgzeW.js";import{i as aa}from"../chunks/CcNT3Cii.js";import{p as ea,o as ta,H as p,I as L,a as sa,c as e,v as K,s as M,J as d,K as v,M as A}from"../chunks/0WvxHNS7.js";import{s as _}from"../chunks/8nUPkhWS.js";import{i as k}from"../chunks/DQ9zl-z8.js";import{l as ra,g as oa,e as P}from"../chunks/BlCfM_qE.js";import{s as la}from"../chunks/BbqHI5c7.js";import{c as na}from"../chunks/B0IwYWdw.js";var ia=f("<p>Loadingâ€¦</p>"),va=f('<p>No entries yet. Go to <a href="/log">Log</a> to create one.</p>'),da=f('<p class="deload">Deload: yes<!></p>'),pa=f('<p class="deload">Deload: no</p>'),fa=f('<a class="row svelte-1xl2tfr"><span class="date"> </span> <span class="meta svelte-1xl2tfr"> </span> <span class="tier svelte-1xl2tfr"> </span> <span class="total svelte-1xl2tfr"> </span></a>'),ca=f('<section class="week svelte-1xl2tfr"><h2> </h2> <!> <div class="list svelte-1xl2tfr"></div></section>'),ma=f('<h1>History</h1> <a class="new svelte-1xl2tfr" href="/log">New / Today</a> <!>',1);function ba(T,U){ea(U,!1);function q(t){const o={scheduled:"scheduled",fatigued_days:"4+ fatigued days",high_average:"high 3-week average"};return t.map(u=>o[u]).join(", ")}let w=K(!0),x=K([]);function z(t){const o=new Map;for(const s of t){const a=oa(s.date),i=o.get(a);i?i.push(s):o.set(a,[s])}const u=Array.from(o.entries()).map(([s,a])=>({weekStart:s,days:a.slice().sort((i,b)=>i.date>b.date?-1:1)})).sort((s,a)=>s.weekStart>a.weekStart?1:-1);return na(u).map(s=>({week:s}))}async function C(){M(w,!0);try{const t=await ra(400);M(x,z(t))}finally{M(w,!1)}}ta(C),aa();var B=ma(),E=p(L(B),4);{var F=t=>{var o=ia();n(t,o)},O=t=>{var o=J(),u=L(o);{var G=a=>{var i=va();n(a,i)},s=a=>{var i=J(),b=L(i);P(b,1,()=>e(x),S=>S.week.weekStart,(S,g)=>{var D=ca(),R=d(D),Q=d(R);v(R);var H=p(R,2);{var V=l=>{var r=da(),c=p(d(r));{var h=y=>{var m=$();A(W=>_(m,`\0 Reasons: ${W??""}`),[()=>q(e(g).week.deloadReasons)]),n(y,m)};k(c,y=>{e(g).week.deloadReasons.length>0&&y(h)})}v(r),n(l,r)},X=l=>{var r=pa();n(l,r)};k(H,l=>{e(g).week.deload?l(V):l(X,!1)})}var N=p(H,2);P(N,5,()=>e(g).week.days,l=>l.day.date,(l,r)=>{var c=fa(),h=d(c),y=d(h,!0);v(h);var m=p(h,2),W=d(m,!0);v(m);var I=p(m,2),Y=d(I,!0);v(I);var j=p(I,2),Z=d(j,!0);v(j),v(c),A(()=>{la(c,"href",`/log?date=${e(r).day.date}`),_(y,e(r).day.date),_(W,e(r).day.readiness),_(Y,e(r).scores.trainingRating),_(Z,e(r).scores.totalPoints)}),n(l,c)}),v(N),v(D),A(()=>_(Q,`Week of ${e(g).week.weekStart??""}`)),n(S,D)}),n(a,i)};k(u,a=>{e(x).length===0?a(G):a(s,!1)},!0)}n(t,o)};k(E,t=>{e(w)?t(F):t(O,!1)})}n(T,B),sa()}export{ba as component};
