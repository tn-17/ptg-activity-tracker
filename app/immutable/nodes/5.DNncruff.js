import{f as k,a as u,c as fa}from"../chunks/CtCoybIn.js";import{i as ua}from"../chunks/BKqJgErF.js";import{p as ka,o as ga,J as q,K as ma,G as t,H as z,a as ya,d as a,y as C,s as w,u as v,c as s,r as e,t as E}from"../chunks/DTfDAl4_.js";import{s as o}from"../chunks/zLC_yYsZ.js";import{i as J}from"../chunks/7tgxHHI9.js";import{l as xa,s as ha,g as Wa,e as Sa}from"../chunks/BDHSxgV7.js";import{a as wa,b as Da,c as ba}from"../chunks/D-yFYO2n.js";var Ma=k("<p>Loadingâ€¦</p>"),Ra=k('<div class="kv svelte-1rn3i1x"><span>Deload reasons</span><span> </span></div>'),Ta=k('<section class="card highlight svelte-1rn3i1x"><h2> </h2> <div class="kv svelte-1rn3i1x"><span>Training points</span><span> </span></div> <div class="kv svelte-1rn3i1x"><span>Wins</span><span> </span></div> <div class="kv svelte-1rn3i1x"><span>Missed days</span><span> </span></div> <div class="kv svelte-1rn3i1x"><span>Weekly rating</span><span> </span></div> <div class="kv svelte-1rn3i1x"><span>Deload</span><span> </span></div> <!> <div class="kv svelte-1rn3i1x"><span>Win streak</span><span> </span></div> <div class="kv svelte-1rn3i1x"><span>Consistency streak</span><span> </span></div></section>'),$a=k("<p>No entries yet.</p>"),Ba=k('<section class="card svelte-1rn3i1x"><h2> </h2> <div class="kv svelte-1rn3i1x"><span>Training points</span><span> </span></div> <div class="kv svelte-1rn3i1x"><span>Wins</span><span> </span></div> <div class="kv svelte-1rn3i1x"><span>Missed days</span><span> </span></div> <div class="kv svelte-1rn3i1x"><span>Weekly rating</span><span> </span></div> <div class="kv svelte-1rn3i1x"><span>Deload</span><span> </span></div></section>'),Ca=k("<!> <!>",1),Ia=k("<h1>Weekly Dashboard</h1> <!>",1);function Ja(sa,ea){ka(ea,!1);const r=C(),O=C(),Q=C();let K=C(!0),c=C([]);function ta(n){const p=n.slice().sort((l,g)=>l.date>g.date?-1:1),d=[];for(const l of p){const g=Wa(l.date),I=d.find(([N])=>N===g);I?I[1].push(l):d.push([g,[l]])}return d}function na(){const n=ha(new Date),p=n.getFullYear(),d=String(n.getMonth()+1).padStart(2,"0"),l=String(n.getDate()).padStart(2,"0");return`${p}-${d}-${l}`}async function ra(){w(K,!0);try{const n=await xa(500),p=ta(n);w(c,ba(p.map(([d,l])=>({weekStart:d,days:l}))))}finally{w(K,!1)}}ga(ra);function ia(n){const p={scheduled:"scheduled",fatigued_days:"4+ fatigued days",high_average:"high 3-week average"};return n.map(d=>p[d]).join(", ")}q(()=>a(c),()=>{w(r,a(c).find(n=>n.weekStart===na())??null)}),q(()=>a(c),()=>{w(O,wa(a(c).flatMap(n=>n.days.map(p=>p.day))))}),q(()=>a(c),()=>{w(Q,Da(a(c)))}),ma(),ua();var V=Ia(),va=t(z(V),2);{var oa=n=>{var p=Ma();u(n,p)},pa=n=>{var p=Ca(),d=z(p);{var l=_=>{var f=Ta(),D=s(f),b=s(D);e(D);var i=t(D,2),m=t(s(i)),M=s(m,!0);e(m),e(i);var R=t(i,2),y=t(s(R)),L=s(y,!0);e(y),e(R);var T=t(R,2),x=t(s(T)),P=s(x,!0);e(x),e(T);var $=t(T,2),h=t(s($)),j=s(h,!0);e(h),e($);var B=t($,2),W=t(s(B)),A=s(W,!0);e(W),e(B);var F=t(B,2);{var G=U=>{var Y=Ra(),aa=t(s(Y)),ca=s(aa,!0);e(aa),e(Y),E(_a=>o(ca,_a),[()=>(a(r),v(()=>ia(a(r).deloadReasons)))]),u(U,Y)};J(F,U=>{a(r),v(()=>a(r).deload&&a(r).deloadReasons.length>0)&&U(G)})}var S=t(F,2),H=t(s(S)),da=s(H);e(H),e(S);var X=t(S,2),Z=t(s(X)),la=s(Z);e(Z),e(X),e(f),E(()=>{o(b,`This week (${a(r),v(()=>a(r).weekStart)??""})`),o(M,(a(r),v(()=>a(r).trainingPoints))),o(L,(a(r),v(()=>a(r).wins))),o(P,(a(r),v(()=>a(r).missedDays))),o(j,(a(r),v(()=>a(r).weeklyRating))),o(A,(a(r),v(()=>a(r).deload?"yes":"no"))),o(da,`${a(O)??""} days`),o(la,`${a(Q)??""} weeks`)}),u(_,f)};J(d,_=>{a(r)&&_(l)})}var g=t(d,2);{var I=_=>{var f=$a();u(_,f)},N=_=>{var f=fa(),D=z(f);Sa(D,1,()=>a(c),b=>b.weekStart,(b,i)=>{var m=Ba(),M=s(m),R=s(M);e(M);var y=t(M,2),L=t(s(y)),T=s(L,!0);e(L),e(y);var x=t(y,2),P=t(s(x)),$=s(P,!0);e(P),e(x);var h=t(x,2),j=t(s(h)),B=s(j,!0);e(j),e(h);var W=t(h,2),A=t(s(W)),F=s(A,!0);e(A),e(W);var G=t(W,2),S=t(s(G)),H=s(S,!0);e(S),e(G),e(m),E(()=>{o(R,`Week of ${a(i),v(()=>a(i).weekStart)??""}`),o(T,(a(i),v(()=>a(i).trainingPoints))),o($,(a(i),v(()=>a(i).wins))),o(B,(a(i),v(()=>a(i).missedDays))),o(F,(a(i),v(()=>a(i).weeklyRating))),o(H,(a(i),v(()=>a(i).deload?"yes":"no")))}),u(b,m)}),u(_,f)};J(g,_=>{a(c),v(()=>a(c).length===0)?_(I):_(N,!1)})}u(n,p)};J(va,n=>{a(K)?n(oa):n(pa,!1)})}u(sa,V),ya()}export{Ja as component};
