import{f as k,a as u,c as fa}from"../chunks/1VXHgzeW.js";import{i as ua}from"../chunks/CcNT3Cii.js";import{p as ka,o as ga,Q as q,R as ma,H as t,I as z,a as ya,c as a,v as B,s as w,u as v,J as s,K as e,M as E}from"../chunks/0WvxHNS7.js";import{s as o}from"../chunks/8nUPkhWS.js";import{i as K}from"../chunks/DQ9zl-z8.js";import{l as xa,s as ha,g as Wa,e as Sa}from"../chunks/BlCfM_qE.js";import{a as wa,b as Da,c as ba}from"../chunks/B0IwYWdw.js";var Ma=k("<p>Loadingâ€¦</p>"),Ra=k('<div class="kv svelte-1rn3i1x"><span>Deload reasons</span><span> </span></div>'),Ia=k('<section class="card highlight svelte-1rn3i1x"><h2> </h2> <div class="kv svelte-1rn3i1x"><span>Training points</span><span> </span></div> <div class="kv svelte-1rn3i1x"><span>Wins</span><span> </span></div> <div class="kv svelte-1rn3i1x"><span>Missed days</span><span> </span></div> <div class="kv svelte-1rn3i1x"><span>Weekly rating</span><span> </span></div> <div class="kv svelte-1rn3i1x"><span>Deload</span><span> </span></div> <!> <div class="kv svelte-1rn3i1x"><span>Win streak</span><span> </span></div> <div class="kv svelte-1rn3i1x"><span>Consistency streak</span><span> </span></div></section>'),Ta=k("<p>No entries yet.</p>"),$a=k('<section class="card svelte-1rn3i1x"><h2> </h2> <div class="kv svelte-1rn3i1x"><span>Training points</span><span> </span></div> <div class="kv svelte-1rn3i1x"><span>Wins</span><span> </span></div> <div class="kv svelte-1rn3i1x"><span>Missed days</span><span> </span></div> <div class="kv svelte-1rn3i1x"><span>Weekly rating</span><span> </span></div> <div class="kv svelte-1rn3i1x"><span>Deload</span><span> </span></div></section>'),Ba=k("<!> <!>",1),Ca=k("<h1>Weekly Dashboard</h1> <!>",1);function Ka(sa,ea){ka(ea,!1);const r=B(),G=B(),O=B();let N=B(!0),c=B([]);function ta(n){const p=n.slice().sort((l,g)=>l.date>g.date?-1:1),d=[];for(const l of p){const g=Wa(l.date),C=d.find(([Q])=>Q===g);C?C[1].push(l):d.push([g,[l]])}return d}function na(){const n=ha(new Date),p=n.getFullYear(),d=String(n.getMonth()+1).padStart(2,"0"),l=String(n.getDate()).padStart(2,"0");return`${p}-${d}-${l}`}async function ra(){w(N,!0);try{const n=await xa(500),p=ta(n);w(c,ba(p.map(([d,l])=>({weekStart:d,days:l}))))}finally{w(N,!1)}}ga(ra);function ia(n){const p={scheduled:"scheduled",fatigued_days:"4+ fatigued days",high_average:"high 3-week average"};return n.map(d=>p[d]).join(", ")}q(()=>a(c),()=>{w(r,a(c).find(n=>n.weekStart===na())??null)}),q(()=>a(c),()=>{w(G,wa(a(c).flatMap(n=>n.days.map(p=>p.day))))}),q(()=>a(c),()=>{w(O,Da(a(c)))}),ma(),ua();var V=Ca(),va=t(z(V),2);{var oa=n=>{var p=Ma();u(n,p)},pa=n=>{var p=Ba(),d=z(p);{var l=_=>{var f=Ia(),D=s(f),b=s(D);e(D);var i=t(D,2),m=t(s(i)),M=s(m,!0);e(m),e(i);var R=t(i,2),y=t(s(R)),L=s(y,!0);e(y),e(R);var I=t(R,2),x=t(s(I)),P=s(x,!0);e(x),e(I);var T=t(I,2),h=t(s(T)),j=s(h,!0);e(h),e(T);var $=t(T,2),W=t(s($)),A=s(W,!0);e(W),e($);var F=t($,2);{var H=U=>{var Y=Ra(),aa=t(s(Y)),ca=s(aa,!0);e(aa),e(Y),E(_a=>o(ca,_a),[()=>(a(r),v(()=>ia(a(r).deloadReasons)))]),u(U,Y)};K(F,U=>{a(r),v(()=>a(r).deload&&a(r).deloadReasons.length>0)&&U(H)})}var S=t(F,2),J=t(s(S)),da=s(J);e(J),e(S);var X=t(S,2),Z=t(s(X)),la=s(Z);e(Z),e(X),e(f),E(()=>{o(b,`This week (${a(r),v(()=>a(r).weekStart)??""})`),o(M,(a(r),v(()=>a(r).trainingPoints))),o(L,(a(r),v(()=>a(r).wins))),o(P,(a(r),v(()=>a(r).missedDays))),o(j,(a(r),v(()=>a(r).weeklyRating))),o(A,(a(r),v(()=>a(r).deload?"yes":"no"))),o(da,`${a(G)??""} days`),o(la,`${a(O)??""} weeks`)}),u(_,f)};K(d,_=>{a(r)&&_(l)})}var g=t(d,2);{var C=_=>{var f=Ta();u(_,f)},Q=_=>{var f=fa(),D=z(f);Sa(D,1,()=>a(c),b=>b.weekStart,(b,i)=>{var m=$a(),M=s(m),R=s(M);e(M);var y=t(M,2),L=t(s(y)),I=s(L,!0);e(L),e(y);var x=t(y,2),P=t(s(x)),T=s(P,!0);e(P),e(x);var h=t(x,2),j=t(s(h)),$=s(j,!0);e(j),e(h);var W=t(h,2),A=t(s(W)),F=s(A,!0);e(A),e(W);var H=t(W,2),S=t(s(H)),J=s(S,!0);e(S),e(H),e(m),E(()=>{o(R,`Week of ${a(i),v(()=>a(i).weekStart)??""}`),o(I,(a(i),v(()=>a(i).trainingPoints))),o(T,(a(i),v(()=>a(i).wins))),o($,(a(i),v(()=>a(i).missedDays))),o(F,(a(i),v(()=>a(i).weeklyRating))),o(J,(a(i),v(()=>a(i).deload?"yes":"no")))}),u(b,m)}),u(_,f)};K(g,_=>{a(c),v(()=>a(c).length===0)?_(C):_(Q,!1)})}u(n,p)};K(va,n=>{a(N)?n(oa):n(pa,!1)})}u(sa,V),ya()}export{Ka as component};
